# =============================================================================
# C1 Northstar Sales Intelligence Platform - Environment Configuration
# =============================================================================

# -----------------------------------------------------------------------------
# Application Settings
# -----------------------------------------------------------------------------
NODE_ENV="development"  # development, production, test
PORT="3000"             # Main application port
WEBSOCKET_PORT="3001"   # WebSocket server port
HOSTNAME="0.0.0.0"      # Server hostname
LOG_LEVEL="info"        # debug, info, warn, error
ENABLE_METRICS="true"   # Enable application metrics collection

# -----------------------------------------------------------------------------
# Database Configuration
# -----------------------------------------------------------------------------
# PostgreSQL connection string
DATABASE_URL="postgresql://northstar:northstar_password@localhost:5432/northstar_db"

# Database connection settings (for docker-compose)
POSTGRES_USER="northstar"
POSTGRES_PASSWORD="northstar_password"
POSTGRES_DB="northstar_db"

# -----------------------------------------------------------------------------
# Redis Configuration (Cache & Job Queue)
# -----------------------------------------------------------------------------
REDIS_HOST="localhost"  # Redis server host
REDIS_PORT="6379"       # Redis server port
REDIS_PASSWORD=""       # Redis password (optional)
REDIS_DB="0"            # Redis database number

# -----------------------------------------------------------------------------
# Qdrant Vector Database Configuration
# -----------------------------------------------------------------------------
QDRANT_HOST="localhost"                    # Qdrant server host
QDRANT_PORT="6333"                         # Qdrant HTTP port
QDRANT_GRPC_PORT="6334"                    # Qdrant gRPC port (optional)
QDRANT_API_KEY=""                          # Qdrant API key (optional)
QDRANT_TIMEOUT="30000"                     # Request timeout in ms
QDRANT_MAX_RETRIES="3"                     # Max retry attempts
QDRANT_RETRY_DELAY="1000"                  # Delay between retries in ms

# Vector Collection Settings
QDRANT_COLLECTION_NAME="northstar_vectors"  # Main collection name
VECTOR_SIZE="1536"                         # Vector dimensions (OpenAI default)
VECTOR_DISTANCE="Cosine"                   # Distance metric: Cosine, Euclid, Dot
VECTOR_ON_DISK="false"                     # Store vectors on disk vs memory
VECTOR_REPLICATION_FACTOR="1"              # Replication factor (optional)
VECTOR_SHARD_NUMBER="1"                    # Number of shards (optional)

# -----------------------------------------------------------------------------
# Authentication (NextAuth.js)
# -----------------------------------------------------------------------------
NEXTAUTH_URL="http://localhost:3000"  # Application URL
NEXTAUTH_SECRET="your-nextauth-secret-32-chars-min"  # Min 32 characters

# Microsoft Entra ID (Azure AD) OAuth
AUTH_MICROSOFT_ENTRA_ID_ID="your-application-client-id"
AUTH_MICROSOFT_ENTRA_ID_SECRET="your-application-client-secret"
AUTH_MICROSOFT_ENTRA_ID_TENANT_ID="your-azure-tenant-id"

# -----------------------------------------------------------------------------
# Azure Storage Configuration (Production)
# -----------------------------------------------------------------------------
AZURE_STORAGE_ACCOUNT="your-storage-account-name"
AZURE_STORAGE_KEY="your-storage-account-key"
AZURE_CONTAINER_NAME="northstar-uploads"
AZURE_STORAGE_CONNECTION_STRING="DefaultEndpointsProtocol=https;AccountName=...;"

# -----------------------------------------------------------------------------
# Azure Container Instances (Production Deployment)
# -----------------------------------------------------------------------------
AZURE_SUBSCRIPTION_ID="your-azure-subscription-id"
AZURE_RESOURCE_GROUP="northstar-rg"
AZURE_LOCATION="eastus"
AZURE_CONTAINER_REGISTRY="northstarregistry.azurecr.io"

# -----------------------------------------------------------------------------
# Scaling Configuration
# -----------------------------------------------------------------------------
APP_REPLICAS="1"        # Number of app replicas in production
WORKER_REPLICAS="1"     # Number of worker replicas
WORKER_CONCURRENCY="2" # Jobs processed concurrently per worker

# -----------------------------------------------------------------------------
# File Upload Configuration
# -----------------------------------------------------------------------------
MAX_FILE_SIZE="10485760"        # 10MB in bytes
UPLOAD_DIR="./uploads"          # Local upload directory
ALLOWED_FILE_TYPES=".pdf,.docx,.xlsx,.csv,.txt"  # Comma-separated

# -----------------------------------------------------------------------------
# Email Configuration (Optional)
# -----------------------------------------------------------------------------
SMTP_HOST="smtp.gmail.com"
SMTP_PORT="587"
SMTP_USER="your-email@domain.com"
SMTP_PASSWORD="your-app-password"
FROM_EMAIL="noreply@c1northstar.com"

# -----------------------------------------------------------------------------
# AI Services Configuration
# -----------------------------------------------------------------------------

# OpenAI Configuration
OPENAI_API_KEY="your-openai-api-key"
OPENAI_BASE_URL="https://api.openai.com/v1"  # Optional: Custom endpoint
OPENAI_MODEL="gpt-4-turbo-preview"           # Default model
OPENAI_MAX_TOKENS="4000"                     # Max tokens per request
OPENAI_TEMPERATURE="0.7"                     # Response creativity (0-1)
OPENAI_TIMEOUT="30000"                       # Request timeout in ms

# Anthropic Configuration
ANTHROPIC_API_KEY="your-anthropic-api-key"
ANTHROPIC_BASE_URL="https://api.anthropic.com"  # Optional: Custom endpoint
ANTHROPIC_MODEL="claude-3-sonnet-20240229"   # Default model
ANTHROPIC_MAX_TOKENS="4000"                  # Max tokens per request
ANTHROPIC_TEMPERATURE="0.7"                  # Response creativity (0-1)
ANTHROPIC_TIMEOUT="30000"                    # Request timeout in ms

# Azure OpenAI Configuration
AZURE_OPENAI_ENDPOINT="your-azure-openai-endpoint"
AZURE_OPENAI_KEY="your-azure-openai-key"
AZURE_OPENAI_MODEL="gpt-4"                   # Deployment name
AZURE_OPENAI_MAX_TOKENS="4000"               # Max tokens per request
AZURE_OPENAI_TEMPERATURE="0.7"               # Response creativity (0-1)
AZURE_OPENAI_TIMEOUT="30000"                 # Request timeout in ms

# Flowise Configuration
FLOWISE_BASE_URL="http://localhost:3000"     # Flowise server URL
FLOWISE_CHATFLOW_ID="your-chatflow-id"       # Default chatflow ID
FLOWISE_API_KEY="your-flowise-api-key"       # Optional: API key
FLOWISE_TIMEOUT="30000"                      # Request timeout in ms

# AI Service Provider Selection
AI_CHAT_PROVIDER="flowise"                   # flowise, openai, anthropic, azure
AI_EMBEDDINGS_PROVIDER="openai"              # openai, azure, anthropic, local
AI_NORMALIZATION_PROVIDER="openai"           # openai, anthropic, azure
AI_INSIGHTS_PROVIDER="anthropic"             # openai, anthropic, azure

# Local Embedding Service (Optional)
LOCAL_EMBEDDING_URL="http://localhost:8000"  # Local embedding service endpoint

# Rate Limiting for AI Services
CHAT_RATE_LIMIT_MINUTE="30"                  # Chat requests per minute
CHAT_RATE_LIMIT_HOUR="500"                   # Chat requests per hour
CHAT_RATE_LIMIT_DAY="2000"                   # Chat requests per day
CHAT_TOKENS_LIMIT_MINUTE="50000"             # Chat tokens per minute
CHAT_TOKENS_LIMIT_HOUR="500000"              # Chat tokens per hour
CHAT_TOKENS_LIMIT_DAY="2000000"              # Chat tokens per day

EMBEDDINGS_RATE_LIMIT_MINUTE="100"           # Embedding requests per minute
EMBEDDINGS_RATE_LIMIT_HOUR="2000"            # Embedding requests per hour
EMBEDDINGS_RATE_LIMIT_DAY="10000"            # Embedding requests per day
EMBEDDINGS_TOKENS_LIMIT_MINUTE="100000"      # Embedding tokens per minute
EMBEDDINGS_TOKENS_LIMIT_HOUR="1000000"       # Embedding tokens per hour
EMBEDDINGS_TOKENS_LIMIT_DAY="5000000"        # Embedding tokens per day

NORMALIZATION_RATE_LIMIT_MINUTE="50"         # Normalization requests per minute
NORMALIZATION_RATE_LIMIT_HOUR="1000"         # Normalization requests per hour
NORMALIZATION_RATE_LIMIT_DAY="5000"          # Normalization requests per day

INSIGHTS_RATE_LIMIT_MINUTE="10"              # Insights requests per minute
INSIGHTS_RATE_LIMIT_HOUR="200"               # Insights requests per hour
INSIGHTS_RATE_LIMIT_DAY="1000"               # Insights requests per day

# AI Service Caching
EMBEDDINGS_CACHE_TTL="86400"                 # 24 hours in seconds
EMBEDDINGS_CACHE_SIZE="10000"                # Max cached embeddings
INSIGHTS_CACHE_TTL="3600"                    # 1 hour in seconds
INSIGHTS_CACHE_SIZE="1000"                   # Max cached insights
NORMALIZATION_CACHE_TTL="7200"               # 2 hours in seconds
NORMALIZATION_CACHE_SIZE="5000"              # Max cached normalizations

# Vector Service Configuration
EMBEDDING_BATCH_SIZE="100"                   # Batch size for embedding generation
EMBEDDING_CHUNK_SIZE="1000"                  # Text chunk size for embeddings
EMBEDDING_CHUNK_OVERLAP="100"                # Overlap between chunks
EMBEDDING_MAX_TOKENS="8000"                  # Max tokens per embedding request

# Vector Search Settings
VECTOR_SEARCH_DEFAULT_LIMIT="10"             # Default search result limit
VECTOR_SEARCH_MAX_LIMIT="100"                # Maximum search result limit
VECTOR_SEARCH_SCORE_THRESHOLD="0.7"          # Minimum similarity score
VECTOR_EXACT_SEARCH="false"                  # Use exact search vs approximate

# Vector Cache Settings
VECTOR_CACHE_ENABLED="true"                  # Enable vector search caching
VECTOR_CACHE_TTL="3600"                      # Vector cache TTL in seconds
VECTOR_CACHE_MAX_SIZE="1000"                 # Max cached search results

# -----------------------------------------------------------------------------
# Monitoring & Observability
# -----------------------------------------------------------------------------
DATADOG_API_KEY="your-datadog-api-key"         # Optional: Datadog monitoring
SENTRY_DSN="your-sentry-dsn"                   # Optional: Error tracking
NEW_RELIC_LICENSE_KEY="your-newrelic-key"      # Optional: APM monitoring

# -----------------------------------------------------------------------------
# Security Configuration
# -----------------------------------------------------------------------------
JWT_SECRET="your-jwt-secret-key-32-chars-min"  # For custom JWT tokens
ENCRYPTION_KEY="your-encryption-key-32-chars"  # For sensitive data encryption
CSRF_SECRET="your-csrf-secret-key"             # CSRF protection

# -----------------------------------------------------------------------------
# Rate Limiting
# -----------------------------------------------------------------------------
RATE_LIMIT_WINDOW_MS="900000"   # 15 minutes in milliseconds
RATE_LIMIT_MAX_REQUESTS="100"   # Max requests per window

# -----------------------------------------------------------------------------
# SSL/TLS Configuration (Production)
# -----------------------------------------------------------------------------
SSL_CERT_PATH="/etc/ssl/certs/northstar.crt"
SSL_KEY_PATH="/etc/ssl/private/northstar.key"
SSL_CA_PATH="/etc/ssl/certs/ca-bundle.crt"

# -----------------------------------------------------------------------------
# Health Check Configuration
# -----------------------------------------------------------------------------
HEALTH_CHECK_INTERVAL="30"      # Seconds between health checks
HEALTH_CHECK_TIMEOUT="10"       # Health check timeout in seconds
READINESS_PROBE_DELAY="60"      # Seconds to wait before readiness probe

# -----------------------------------------------------------------------------
# Backup Configuration
# -----------------------------------------------------------------------------
BACKUP_ENABLED="true"           # Enable automated backups
BACKUP_SCHEDULE="0 2 * * *"     # Daily at 2 AM (cron format)
BACKUP_RETENTION_DAYS="30"      # Keep backups for 30 days
BACKUP_STORAGE_PATH="/backups"  # Local backup storage path